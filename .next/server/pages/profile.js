(()=>{var e={};e.id=277,e.ids=[277,888,660],e.modules={7116:(e,s,t)=>{"use strict";t.r(s),t.d(s,{config:()=>C,default:()=>N,getServerSideProps:()=>k,getStaticPaths:()=>S,getStaticProps:()=>w,reportWebVitals:()=>P,routeModule:()=>_,unstable_getServerProps:()=>E,unstable_getServerSideProps:()=>$,unstable_getStaticParams:()=>A,unstable_getStaticPaths:()=>q,unstable_getStaticProps:()=>D});var r={};t.r(r),t.d(r,{default:()=>v});var a=t(7093),l=t(5244),i=t(1323),n=t(8942),d=t(5780),c=t(997),o=t(6689),x=t.n(o),m=t(1649),h=t(5734),u=t(3524),p=t(1664),g=t.n(p),j=t(1163),b=t(641);let f=({searchQuery:e,onSearchChange:s,statusFilter:t,onStatusChange:r,dateRange:a,onDateRangeChange:l})=>c.jsx("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"キーワード検索"}),c.jsx("input",{type:"text",id:"search",value:e,onChange:e=>s(e.target.value),placeholder:"注文番号、商品名など",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"注文状態"}),(0,c.jsxs)("select",{id:"status",value:t,onChange:e=>r(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"",children:"すべて"}),c.jsx("option",{value:"pending",children:"保留中"}),c.jsx("option",{value:"processing",children:"処理中"}),c.jsx("option",{value:"shipped",children:"発送済み"}),c.jsx("option",{value:"delivered",children:"配達完了"}),c.jsx("option",{value:"cancelled",children:"キャンセル"})]})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"開始日"}),c.jsx("input",{type:"date",id:"startDate",value:a.start,onChange:e=>l({...a,start:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"終了日"}),c.jsx("input",{type:"date",id:"endDate",value:a.end,onChange:e=>l({...a,end:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})}),y=new u.PrismaClient,v=()=>{let{data:e}=(0,m.useSession)(),[s,t]=(0,o.useState)("profile"),[r,a]=(0,o.useState)(null);(0,j.useRouter)();let[l,i]=(0,o.useState)(""),[n,d]=(0,o.useState)("all"),[u,p]=(0,o.useState)({start:"",end:""}),[v,N]=(0,o.useState)([]),[w,S]=(0,o.useState)(1),[k,C]=(0,o.useState)(1),[P,D]=(0,o.useState)(!0),[q,A]=(0,o.useState)(""),[E,$]=(0,o.useState)([]);x().useEffect(()=>{(async()=>{if(e?.user?.id){let s=await y.user.findUnique({where:{id:e.user.id},select:{name:!0,email:!0,addresses:{select:{id:!0,name:!0,zipCode:!0,prefecture:!0,city:!0,street:!0,building:!0,phone:!0,isDefault:!0}},orders:{select:{id:!0,createdAt:!0,status:!0,totalAmount:!0,items:{select:{id:!0,productName:!0,quantity:!0,price:!0,customization:!0}}}}}});s&&a({name:s.name,email:s.email,addresses:s.addresses,orders:s.orders})}})()},[e]),(0,o.useEffect)(()=>{let t=async()=>{if(e?.user?.id)try{let e=new URLSearchParams({page:w.toString(),limit:"10",search:l,status:n,startDate:u.start,endDate:u.end}),s=await fetch(`/api/orders?${e}`);if(!s.ok)throw Error("注文データの取得に失敗しました");let t=await s.json();N(t.orders),C(t.totalPages)}catch(e){console.error("注文データの取得エラー:",e),A("注文データの取得に失敗しました")}finally{D(!1)}};"orders"===s&&t()},[e,s,w,l,n,u]);let _=e=>{S(e)},L=e=>{$(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])};return e?c.jsx(h.Z,{children:(0,c.jsxs)("div",{className:"max-w-4xl mx-auto py-12",children:[c.jsx("h1",{className:"text-3xl font-bold mb-8",children:"マイページ"}),c.jsx("div",{className:"border-b border-gray-200 mb-8",children:(0,c.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[c.jsx("button",{onClick:()=>t("profile"),className:`${"profile"===s?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:"プロフィール"}),c.jsx("button",{onClick:()=>t("addresses"),className:`${"addresses"===s?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:"配送先住所"}),c.jsx("button",{onClick:()=>t("orders"),className:`${"orders"===s?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:"注文履歴"})]})}),"profile"===s&&(0,c.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"プロフィール情報"}),(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"お名前"}),c.jsx("p",{className:"mt-1 text-gray-900",children:r?.name})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"メールアドレス"}),c.jsx("p",{className:"mt-1 text-gray-900",children:r?.email})]}),(0,c.jsxs)("div",{className:"flex space-x-4",children:[c.jsx(g(),{href:"/profile/edit",className:"btn-primary",children:"プロフィールを編集"}),c.jsx(g(),{href:"/profile/password",className:"btn-secondary",children:"パスワードを変更"})]})]})]}),"addresses"===s&&(0,c.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"配送先住所"}),c.jsx(g(),{href:"/profile/addresses/new",className:"btn-primary",children:"新規住所を追加"})]}),c.jsx("div",{className:"space-y-4",children:r?.addresses.map(e=>c.jsx("div",{className:"border rounded-lg p-4",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:e.name}),c.jsxs("p",{className:"text-sm text-gray-600",children:["〒",e.zipCode,c.jsx("br",{}),e.prefecture,e.city,e.street,e.building&&c.jsx("br",{}),e.building]}),c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["TEL: ",e.phone]}),e.isDefault&&c.jsx("span",{className:"inline-block mt-1 px-2 py-1 text-xs bg-primary text-white rounded",children:"デフォルト"})]}),c.jsx("div",{className:"flex space-x-2",children:c.jsx(g(),{href:`/profile/addresses/${e.id}`,className:"btn-secondary text-sm",children:"編集"})})]})},e.id))})]}),"orders"===s&&(0,c.jsxs)("div",{className:"space-y-6",children:[c.jsx(f,{searchQuery:l,onSearchChange:i,statusFilter:n,onStatusChange:d,dateRange:u,onDateRangeChange:p}),P?c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-600",children:"読み込み中..."})}):q?c.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:q}):0===v.length?c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-600",children:"注文履歴がありません"})}):(0,c.jsxs)(c.Fragment,{children:[c.jsx("div",{className:"flex justify-between items-center mb-4",children:(0,c.jsxs)("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:()=>$(E.length===v.length?[]:v.map(e=>e.id)),className:`px-3 py-1 rounded text-sm ${E.length===v.length?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:E.length===v.length?"すべて解除":"すべて選択"}),E.length>0&&(0,c.jsxs)("button",{onClick:()=>{if(0===E.length)return;let e=v.filter(e=>E.includes(e.id)).map(e=>(0,b.V)(e.id,{carrier:e.trackingInfo?.carrier||"",trackingNumber:e.trackingInfo?.trackingNumber||"",status:e.trackingInfo?.status||"",estimatedDelivery:e.trackingInfo?.estimatedDelivery||null,currentLocation:e.trackingInfo?.currentLocation||null,history:e.trackingInfo?.history||[]})).join("\n\n");(0,b.n)(e,`tracking_${new Date().toISOString().split("T")[0]}.csv`)},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"選択した注文をエクスポート"]})]})}),c.jsx("div",{className:"space-y-4",children:v.map(e=>c.jsx(g(),{href:`/profile/orders/${e.id}`,className:"block bg-white shadow rounded-lg p-6 hover:shadow-md transition-shadow",children:(0,c.jsxs)("div",{className:"flex items-start space-x-4",children:[c.jsx("input",{type:"checkbox",checked:E.includes(e.id),onChange:s=>{s.stopPropagation(),L(e.id)},className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"flex justify-between items-start",children:[(0,c.jsxs)("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"注文番号"}),c.jsx("p",{className:"font-medium",children:e.id})]}),(0,c.jsxs)("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"注文日時"}),c.jsx("p",{className:"font-medium",children:new Date(e.createdAt).toLocaleString("ja-JP")})]})]}),(0,c.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,c.jsxs)("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"状態"}),c.jsx("p",{className:"font-medium",children:e.status})]}),(0,c.jsxs)("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"合計金額"}),(0,c.jsxs)("p",{className:"font-medium",children:["\xa5",e.totalAmount.toLocaleString()]})]})]}),"cancelled"===e.status&&e.cancelReason&&(0,c.jsxs)("div",{className:"mt-4",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"キャンセル理由"}),c.jsx("p",{className:"text-sm line-clamp-2",children:e.cancelReason})]})]})]})},e.id))}),k>1&&(0,c.jsxs)("div",{className:"flex justify-center space-x-2 mt-8",children:[c.jsx("button",{onClick:()=>_(w-1),disabled:1===w,className:`px-3 py-1 rounded ${1===w?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"前へ"}),Array.from({length:k},(e,s)=>s+1).map(e=>c.jsx("button",{onClick:()=>_(e),className:`px-3 py-1 rounded ${w===e?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:e},e)),c.jsx("button",{onClick:()=>_(w+1),disabled:w===k,className:`px-3 py-1 rounded ${w===k?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"次へ"})]})]})]})]})}):c.jsx(h.Z,{children:(0,c.jsxs)("div",{className:"max-w-4xl mx-auto py-12 text-center",children:[c.jsx("h1",{className:"text-3xl font-bold mb-4",children:"ログインが必要です"}),c.jsx("p",{className:"text-gray-600 mb-8",children:"プロフィールを表示するにはログインしてください。"})]})})},N=(0,i.l)(r,"default"),w=(0,i.l)(r,"getStaticProps"),S=(0,i.l)(r,"getStaticPaths"),k=(0,i.l)(r,"getServerSideProps"),C=(0,i.l)(r,"config"),P=(0,i.l)(r,"reportWebVitals"),D=(0,i.l)(r,"unstable_getStaticProps"),q=(0,i.l)(r,"unstable_getStaticPaths"),A=(0,i.l)(r,"unstable_getStaticParams"),E=(0,i.l)(r,"unstable_getServerProps"),$=(0,i.l)(r,"unstable_getServerSideProps"),_=new a.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/profile",pathname:"/profile",bundlePath:"",filename:""},components:{App:d.default,Document:n.default},userland:r})},5734:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});var r=t(997);t(6689);var a=t(1664),l=t.n(a),i=t(1649);let n=({children:e})=>{let{data:s}=(0,i.useSession)();return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[r.jsx("header",{className:"bg-white shadow",children:r.jsx("nav",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsxs)("div",{className:"flex",children:[r.jsx(l(),{href:"/",className:"flex items-center",children:r.jsx("span",{className:"text-xl font-bold text-primary",children:"AparelEC"})}),(0,r.jsxs)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[r.jsx(l(),{href:"/customize",className:"inline-flex items-center px-1 pt-1 text-gray-900 hover:text-primary",children:"カスタマイズ"}),r.jsx(l(),{href:"/products",className:"inline-flex items-center px-1 pt-1 text-gray-900 hover:text-primary",children:"商品一覧"})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(l(),{href:"/cart",className:"p-2 text-gray-900 hover:text-primary",children:"\uD83D\uDED2 カート"}),s?(0,r.jsxs)("div",{className:"ml-4 flex items-center space-x-4",children:[r.jsx(l(),{href:"/profile",className:"text-gray-900 hover:text-primary",children:"マイページ"}),r.jsx("button",{onClick:()=>(0,i.signOut)(),className:"text-gray-900 hover:text-primary",children:"ログアウト"})]}):(0,r.jsxs)("div",{className:"ml-4 flex items-center space-x-4",children:[r.jsx(l(),{href:"/auth/login",className:"text-gray-900 hover:text-primary",children:"ログイン"}),r.jsx(l(),{href:"/auth/register",className:"bg-primary text-white px-4 py-2 rounded hover:bg-primary/90",children:"新規登録"})]})]})]})})}),r.jsx("main",{className:"flex-grow",children:e}),r.jsx("footer",{className:"bg-gray-800 text-white",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"AparelEC"}),(0,r.jsxs)("p",{className:"text-gray-400",children:["高品質なスポーツユニフォームを",r.jsx("br",{}),"お手頃価格で提供します"]})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"リンク"}),(0,r.jsxs)("ul",{className:"space-y-2",children:[r.jsx("li",{children:r.jsx(l(),{href:"/about",className:"text-gray-400 hover:text-white",children:"会社概要"})}),r.jsx("li",{children:r.jsx(l(),{href:"/contact",className:"text-gray-400 hover:text-white",children:"お問い合わせ"})}),r.jsx("li",{children:r.jsx(l(),{href:"/privacy",className:"text-gray-400 hover:text-white",children:"プライバシーポリシー"})})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"お問い合わせ"}),(0,r.jsxs)("p",{className:"text-gray-400",children:["メール: info@aparelec.com",r.jsx("br",{}),"電話: 03-1234-5678"]})]})]}),r.jsx("div",{className:"mt-8 pt-8 border-t border-gray-700 text-center text-gray-400",children:r.jsx("p",{children:"\xa9 2024 AparelEC. All rights reserved."})})]})})]})}},5780:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var r=t(997);t(6764);var a=t(968),l=t.n(a);let i=function({Component:e,pageProps:s}){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l(),{children:[r.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),r.jsx("meta",{name:"description",content:"AparelEC - オンラインアパレルショップ"}),r.jsx("link",{rel:"icon",href:"/favicon.ico"})]}),r.jsx(e,{...s})]})}},8942:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var r=t(997),a=t(6859),l=t.n(a);class i extends l(){render(){return(0,r.jsxs)(a.Html,{lang:"ja",children:[(0,r.jsxs)(a.Head,{children:[r.jsx("meta",{charSet:"utf-8"}),r.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),r.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"}),r.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap",rel:"stylesheet"})]}),(0,r.jsxs)("body",{children:[r.jsx(a.Main,{}),r.jsx(a.NextScript,{})]})]})}}let n=i},641:(e,s,t)=>{"use strict";t.d(s,{V:()=>r,n:()=>a});let r=e=>["タイムスタンプ,ステータス,場所",...e.map(e=>[e.timestamp,e.status,e.location]).map(e=>e.join(","))].join("\n"),a=(e,s)=>{let t=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),a=URL.createObjectURL(t);r.setAttribute("href",a),r.setAttribute("download",s),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},6764:()=>{},3524:e=>{"use strict";e.exports=require("@prisma/client")},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{"use strict";e.exports=require("next/head")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},7147:e=>{"use strict";e.exports=require("fs")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},9796:e=>{"use strict";e.exports=require("zlib")}};var s=require("../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[859,238,664,163],()=>t(7116));module.exports=r})();