(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[563],{2086:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/reset-password/request",function(){return r(9463)}])},5822:function(e,s,r){"use strict";var t=r(5893);r(7294);var a=r(1664),i=r.n(a),n=r(3299);s.Z=e=>{let{children:s}=e,{data:r}=(0,n.useSession)();return(0,t.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,t.jsx)("header",{className:"bg-white shadow",children:(0,t.jsx)("nav",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)(i(),{href:"/",className:"flex items-center",children:(0,t.jsx)("span",{className:"text-xl font-bold text-primary",children:"AparelEC"})}),(0,t.jsxs)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[(0,t.jsx)(i(),{href:"/customize",className:"inline-flex items-center px-1 pt-1 text-gray-900 hover:text-primary",children:"カスタマイズ"}),(0,t.jsx)(i(),{href:"/products",className:"inline-flex items-center px-1 pt-1 text-gray-900 hover:text-primary",children:"商品一覧"})]})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(i(),{href:"/cart",className:"p-2 text-gray-900 hover:text-primary",children:"\uD83D\uDED2 カート"}),r?(0,t.jsxs)("div",{className:"ml-4 flex items-center space-x-4",children:[(0,t.jsx)(i(),{href:"/profile",className:"text-gray-900 hover:text-primary",children:"マイページ"}),(0,t.jsx)("button",{onClick:()=>(0,n.signOut)(),className:"text-gray-900 hover:text-primary",children:"ログアウト"})]}):(0,t.jsxs)("div",{className:"ml-4 flex items-center space-x-4",children:[(0,t.jsx)(i(),{href:"/auth/login",className:"text-gray-900 hover:text-primary",children:"ログイン"}),(0,t.jsx)(i(),{href:"/auth/register",className:"bg-primary text-white px-4 py-2 rounded hover:bg-primary/90",children:"新規登録"})]})]})]})})}),(0,t.jsx)("main",{className:"flex-grow",children:s}),(0,t.jsx)("footer",{className:"bg-gray-800 text-white",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"AparelEC"}),(0,t.jsxs)("p",{className:"text-gray-400",children:["高品質なスポーツユニフォームを",(0,t.jsx)("br",{}),"お手頃価格で提供します"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"リンク"}),(0,t.jsxs)("ul",{className:"space-y-2",children:[(0,t.jsx)("li",{children:(0,t.jsx)(i(),{href:"/about",className:"text-gray-400 hover:text-white",children:"会社概要"})}),(0,t.jsx)("li",{children:(0,t.jsx)(i(),{href:"/contact",className:"text-gray-400 hover:text-white",children:"お問い合わせ"})}),(0,t.jsx)("li",{children:(0,t.jsx)(i(),{href:"/privacy",className:"text-gray-400 hover:text-white",children:"プライバシーポリシー"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"お問い合わせ"}),(0,t.jsxs)("p",{className:"text-gray-400",children:["メール: info@aparelec.com",(0,t.jsx)("br",{}),"電話: 03-1234-5678"]})]})]}),(0,t.jsx)("div",{className:"mt-8 pt-8 border-t border-gray-700 text-center text-gray-400",children:(0,t.jsx)("p",{children:"\xa9 2024 AparelEC. All rights reserved."})})]})})]})}},9463:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return o}});var t=r(5893),a=r(7294),i=r(1163),n=r(5822),l=r(385),c=r(2474),d=r.n(c);async function x(e,s){try{if(!(await fetch("/api/mail/send-password-reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,resetToken:s})})).ok)throw Error("メール送信に失敗しました");return!0}catch(e){return console.error("メール送信エラー:",e),!1}}r(162);let h=new l.PrismaClient;var o=()=>{let e=(0,i.useRouter)(),[s,r]=(0,a.useState)(""),[l,c]=(0,a.useState)(""),[o,m]=(0,a.useState)(""),[u,p]=(0,a.useState)(!1),f=async e=>{e.preventDefault(),c(""),m(""),p(!0);try{let e=await h.user.findUnique({where:{email:s}});if(!e){m("パスワードリセット用のリンクを送信しました"),p(!1);return}let r=d().randomBytes(32).toString("hex"),t=new Date(Date.now()+36e5);if(await h.user.update({where:{id:e.id},data:{resetToken:r,resetTokenExpiry:t}}),!await x(s,r))throw Error("メール送信に失敗しました");m("パスワードリセット用のリンクを送信しました")}catch(e){console.error("パスワードリセットエラー:",e),c("パスワードリセットのリクエストに失敗しました")}finally{p(!1)}};return(0,t.jsx)(n.Z,{children:(0,t.jsxs)("div",{className:"max-w-md mx-auto py-12",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"パスワードリセット"}),l&&(0,t.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:l}),o&&(0,t.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:o}),(0,t.jsx)("form",{onSubmit:f,className:"bg-white shadow rounded-lg p-6",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"メールアドレス"}),(0,t.jsx)("input",{type:"email",id:"email",value:s,onChange:e=>r(e.target.value),className:"input-field",required:!0,disabled:u})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>e.push("/auth/signin"),className:"btn-secondary",disabled:u,children:"ログインページに戻る"}),(0,t.jsx)("button",{type:"submit",className:"btn-primary",disabled:u,children:u?"送信中...":"リセットリンクを送信"})]})]})})]})})}},6011:function(){},8188:function(){},135:function(){},4071:function(){},7569:function(){},5041:function(){},7286:function(){},4240:function(){},5570:function(){},2481:function(){},3872:function(){}},function(e){e.O(0,[714,664,299,257,817,162,888,774,179],function(){return e(e.s=2086)}),_N_E=e.O()}]);