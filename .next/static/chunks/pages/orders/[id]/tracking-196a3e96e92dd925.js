(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[799],{9072:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/orders/[id]/tracking",function(){return t(9223)}])},9223:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return l}});var r=t(5893),i=t(7294),a=t(1163),n=t(3299);function l(){var e;let s=(0,a.useRouter)(),{data:t,status:l}=(0,n.useSession)(),[c,d]=(0,i.useState)(null),[o,m]=(0,i.useState)(null),[x,h]=(0,i.useState)(!0),{id:j}=s.query;return((0,i.useEffect)(()=>{if(j&&"loading"!==l){if(!t){s.push("/auth/signin");return}(async()=>{try{h(!0);let e=await fetch("".concat("http://localhost:8888/.netlify/functions","/tracking?orderId=").concat(j),{headers:{Authorization:"Bearer ".concat(t.accessToken)}});if(!e.ok){let s=await e.json();m(s);return}let s=await e.json();d(s)}catch(e){m({message:"配送情報の取得中にエラーが発生しました",code:"FETCH_ERROR",statusCode:500}),console.error("Tracking info fetch error:",e)}finally{h(!1)}})()}},[j,t,l,s]),x)?(0,r.jsx)("div",{className:"text-center p-4",children:"読み込み中..."}):o?(0,r.jsx)("div",{className:"max-w-2xl mx-auto p-4",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)("svg",{className:"w-6 h-6 text-red-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("h2",{className:"text-lg font-semibold text-red-700",children:"エラーが発生しました"})]}),(0,r.jsx)("p",{className:"text-red-600 mb-2",children:o.message}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsxs)("p",{children:["エラーコード: ",o.code]}),(0,r.jsxs)("p",{children:["ステータスコード: ",o.statusCode]})]}),(0,r.jsxs)("button",{onClick:()=>window.location.reload(),className:"mt-4 inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"再読み込み"]})]})}):c?(0,r.jsxs)("div",{className:"max-w-2xl mx-auto p-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"配送状況"}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"追跡番号"}),(0,r.jsx)("p",{className:"font-semibold",children:c.trackingNumber})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"配送業者"}),(0,r.jsx)("p",{className:"font-semibold",children:c.carrier})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"現在の状況"}),(0,r.jsx)("p",{className:"font-semibold",children:c.status})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"現在地"}),(0,r.jsx)("p",{className:"font-semibold",children:c.currentLocation})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"最終更新"}),(0,r.jsx)("p",{className:"font-semibold",children:new Date(c.timestamp).toLocaleString("ja-JP")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"配達予定日時"}),(0,r.jsx)("p",{className:"font-semibold",children:c.estimatedDelivery?new Date(c.estimatedDelivery).toLocaleString("ja-JP"):"未定"})]})]}),(0,r.jsxs)("div",{className:"border-t pt-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"配送履歴"}),(0,r.jsx)("div",{className:"space-y-4",children:null===(e=c.history)||void 0===e?void 0:e.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-32 text-sm text-gray-600",children:new Date(e.timestamp).toLocaleString("ja-JP")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:e.status}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.location}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]})]},s))})]}),c.additionalInfo&&Object.keys(c.additionalInfo).length>0&&(0,r.jsxs)("div",{className:"border-t mt-6 pt-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"追加情報"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(c.additionalInfo).map(e=>{let[s,t]=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:s}),(0,r.jsx)("p",{className:"font-semibold",children:t})]},s)})})]})]})]}):(0,r.jsx)("div",{className:"text-center p-4",children:"配送情報が見つかりません"})}},1163:function(e,s,t){e.exports=t(4546)}},function(e){e.O(0,[299,888,774,179],function(){return e(e.s=9072)}),_N_E=e.O()}]);