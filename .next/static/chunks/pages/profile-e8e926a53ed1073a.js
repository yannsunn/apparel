(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{9813:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return t(3497)}])},5822:function(e,s,t){"use strict";var r=t(5893);t(7294);var a=t(1664),l=t.n(a),i=t(3299);s.Z=e=>{let{children:s}=e,{data:t}=(0,i.useSession)();return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)("header",{className:"bg-white shadow",children:(0,r.jsx)("nav",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(l(),{href:"/",className:"flex items-center",children:(0,r.jsx)("span",{className:"text-xl font-bold text-primary",children:"AparelEC"})}),(0,r.jsxs)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[(0,r.jsx)(l(),{href:"/customize",className:"inline-flex items-center px-1 pt-1 text-gray-900 hover:text-primary",children:"カスタマイズ"}),(0,r.jsx)(l(),{href:"/products",className:"inline-flex items-center px-1 pt-1 text-gray-900 hover:text-primary",children:"商品一覧"})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(l(),{href:"/cart",className:"p-2 text-gray-900 hover:text-primary",children:"\uD83D\uDED2 カート"}),t?(0,r.jsxs)("div",{className:"ml-4 flex items-center space-x-4",children:[(0,r.jsx)(l(),{href:"/profile",className:"text-gray-900 hover:text-primary",children:"マイページ"}),(0,r.jsx)("button",{onClick:()=>(0,i.signOut)(),className:"text-gray-900 hover:text-primary",children:"ログアウト"})]}):(0,r.jsxs)("div",{className:"ml-4 flex items-center space-x-4",children:[(0,r.jsx)(l(),{href:"/auth/login",className:"text-gray-900 hover:text-primary",children:"ログイン"}),(0,r.jsx)(l(),{href:"/auth/register",className:"bg-primary text-white px-4 py-2 rounded hover:bg-primary/90",children:"新規登録"})]})]})]})})}),(0,r.jsx)("main",{className:"flex-grow",children:s}),(0,r.jsx)("footer",{className:"bg-gray-800 text-white",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"AparelEC"}),(0,r.jsxs)("p",{className:"text-gray-400",children:["高品質なスポーツユニフォームを",(0,r.jsx)("br",{}),"お手頃価格で提供します"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"リンク"}),(0,r.jsxs)("ul",{className:"space-y-2",children:[(0,r.jsx)("li",{children:(0,r.jsx)(l(),{href:"/about",className:"text-gray-400 hover:text-white",children:"会社概要"})}),(0,r.jsx)("li",{children:(0,r.jsx)(l(),{href:"/contact",className:"text-gray-400 hover:text-white",children:"お問い合わせ"})}),(0,r.jsx)("li",{children:(0,r.jsx)(l(),{href:"/privacy",className:"text-gray-400 hover:text-white",children:"プライバシーポリシー"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"お問い合わせ"}),(0,r.jsxs)("p",{className:"text-gray-400",children:["メール: info@aparelec.com",(0,r.jsx)("br",{}),"電話: 03-1234-5678"]})]})]}),(0,r.jsx)("div",{className:"mt-8 pt-8 border-t border-gray-700 text-center text-gray-400",children:(0,r.jsx)("p",{children:"\xa9 2024 AparelEC. All rights reserved."})})]})})]})}},3497:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var r=t(5893),a=t(7294),l=t(3299),i=t(5822),n=t(385),d=t(1664),c=t.n(d),o=t(1163),x=t(5753),m=e=>{let{searchQuery:s,onSearchChange:t,statusFilter:a,onStatusChange:l,dateRange:i,onDateRangeChange:n}=e;return(0,r.jsx)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"キーワード検索"}),(0,r.jsx)("input",{type:"text",id:"search",value:s,onChange:e=>t(e.target.value),placeholder:"注文番号、商品名など",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"注文状態"}),(0,r.jsxs)("select",{id:"status",value:a,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"",children:"すべて"}),(0,r.jsx)("option",{value:"pending",children:"保留中"}),(0,r.jsx)("option",{value:"processing",children:"処理中"}),(0,r.jsx)("option",{value:"shipped",children:"発送済み"}),(0,r.jsx)("option",{value:"delivered",children:"配達完了"}),(0,r.jsx)("option",{value:"cancelled",children:"キャンセル"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"開始日"}),(0,r.jsx)("input",{type:"date",id:"startDate",value:i.start,onChange:e=>n({...i,start:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"終了日"}),(0,r.jsx)("input",{type:"date",id:"endDate",value:i.end,onChange:e=>n({...i,end:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})})};let h=new n.PrismaClient;var u=()=>{let{data:e}=(0,l.useSession)(),[s,t]=(0,a.useState)("profile"),[n,d]=(0,a.useState)(null);(0,o.useRouter)();let[u,p]=(0,a.useState)(""),[g,j]=(0,a.useState)("all"),[b,f]=(0,a.useState)({start:"",end:""}),[y,v]=(0,a.useState)([]),[N,w]=(0,a.useState)(1),[k,C]=(0,a.useState)(1),[S,D]=(0,a.useState)(!0),[E,_]=(0,a.useState)(""),[A,L]=(0,a.useState)([]);a.useEffect(()=>{(async()=>{var s;if(null==e?void 0:null===(s=e.user)||void 0===s?void 0:s.id){let s=await h.user.findUnique({where:{id:e.user.id},select:{name:!0,email:!0,addresses:{select:{id:!0,name:!0,zipCode:!0,prefecture:!0,city:!0,street:!0,building:!0,phone:!0,isDefault:!0}},orders:{select:{id:!0,createdAt:!0,status:!0,totalAmount:!0,items:{select:{id:!0,productName:!0,quantity:!0,price:!0,customization:!0}}}}}});s&&d({name:s.name,email:s.email,addresses:s.addresses,orders:s.orders})}})()},[e]),(0,a.useEffect)(()=>{let t=async()=>{var s;if(null==e?void 0:null===(s=e.user)||void 0===s?void 0:s.id)try{let e=new URLSearchParams({page:N.toString(),limit:"10",search:u,status:g,startDate:b.start,endDate:b.end}),s=await fetch("/api/orders?".concat(e));if(!s.ok)throw Error("注文データの取得に失敗しました");let t=await s.json();v(t.orders),C(t.totalPages)}catch(e){console.error("注文データの取得エラー:",e),_("注文データの取得に失敗しました")}finally{D(!1)}};"orders"===s&&t()},[e,s,N,u,g,b]);let R=e=>{w(e)},I=e=>{L(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])};return e?(0,r.jsx)(i.Z,{children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto py-12",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"マイページ"}),(0,r.jsx)("div",{className:"border-b border-gray-200 mb-8",children:(0,r.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,r.jsx)("button",{onClick:()=>t("profile"),className:"".concat("profile"===s?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"プロフィール"}),(0,r.jsx)("button",{onClick:()=>t("addresses"),className:"".concat("addresses"===s?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"配送先住所"}),(0,r.jsx)("button",{onClick:()=>t("orders"),className:"".concat("orders"===s?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"注文履歴"})]})}),"profile"===s&&(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"プロフィール情報"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"お名前"}),(0,r.jsx)("p",{className:"mt-1 text-gray-900",children:null==n?void 0:n.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"メールアドレス"}),(0,r.jsx)("p",{className:"mt-1 text-gray-900",children:null==n?void 0:n.email})]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)(c(),{href:"/profile/edit",className:"btn-primary",children:"プロフィールを編集"}),(0,r.jsx)(c(),{href:"/profile/password",className:"btn-secondary",children:"パスワードを変更"})]})]})]}),"addresses"===s&&(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"配送先住所"}),(0,r.jsx)(c(),{href:"/profile/addresses/new",className:"btn-primary",children:"新規住所を追加"})]}),(0,r.jsx)("div",{className:"space-y-4",children:null==n?void 0:n.addresses.map(e=>(0,r.jsx)("div",{className:"border rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["〒",e.zipCode,(0,r.jsx)("br",{}),e.prefecture,e.city,e.street,e.building&&(0,r.jsx)("br",{}),e.building]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["TEL: ",e.phone]}),e.isDefault&&(0,r.jsx)("span",{className:"inline-block mt-1 px-2 py-1 text-xs bg-primary text-white rounded",children:"デフォルト"})]}),(0,r.jsx)("div",{className:"flex space-x-2",children:(0,r.jsx)(c(),{href:"/profile/addresses/".concat(e.id),className:"btn-secondary text-sm",children:"編集"})})]})},e.id))})]}),"orders"===s&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(m,{searchQuery:u,onSearchChange:p,statusFilter:g,onStatusChange:j,dateRange:b,onDateRangeChange:f}),S?(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("p",{className:"text-gray-600",children:"読み込み中..."})}):E?(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:E}):0===y.length?(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("p",{className:"text-gray-600",children:"注文履歴がありません"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>L(A.length===y.length?[]:y.map(e=>e.id)),className:"px-3 py-1 rounded text-sm ".concat(A.length===y.length?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:A.length===y.length?"すべて解除":"すべて選択"}),A.length>0&&(0,r.jsxs)("button",{onClick:()=>{if(0===A.length)return;let e=y.filter(e=>A.includes(e.id)).map(e=>{var s,t,r,a,l,i;return(0,x.V)(e.id,{carrier:(null===(s=e.trackingInfo)||void 0===s?void 0:s.carrier)||"",trackingNumber:(null===(t=e.trackingInfo)||void 0===t?void 0:t.trackingNumber)||"",status:(null===(r=e.trackingInfo)||void 0===r?void 0:r.status)||"",estimatedDelivery:(null===(a=e.trackingInfo)||void 0===a?void 0:a.estimatedDelivery)||null,currentLocation:(null===(l=e.trackingInfo)||void 0===l?void 0:l.currentLocation)||null,history:(null===(i=e.trackingInfo)||void 0===i?void 0:i.history)||[]})}).join("\n\n");(0,x.n)(e,"tracking_".concat(new Date().toISOString().split("T")[0],".csv"))},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"選択した注文をエクスポート"]})]})}),(0,r.jsx)("div",{className:"space-y-4",children:y.map(e=>(0,r.jsx)(c(),{href:"/profile/orders/".concat(e.id),className:"block bg-white shadow rounded-lg p-6 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,r.jsx)("input",{type:"checkbox",checked:A.includes(e.id),onChange:s=>{s.stopPropagation(),I(e.id)},className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"注文番号"}),(0,r.jsx)("p",{className:"font-medium",children:e.id})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"注文日時"}),(0,r.jsx)("p",{className:"font-medium",children:new Date(e.createdAt).toLocaleString("ja-JP")})]})]}),(0,r.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"状態"}),(0,r.jsx)("p",{className:"font-medium",children:e.status})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"合計金額"}),(0,r.jsxs)("p",{className:"font-medium",children:["\xa5",e.totalAmount.toLocaleString()]})]})]}),"cancelled"===e.status&&e.cancelReason&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"キャンセル理由"}),(0,r.jsx)("p",{className:"text-sm line-clamp-2",children:e.cancelReason})]})]})]})},e.id))}),k>1&&(0,r.jsxs)("div",{className:"flex justify-center space-x-2 mt-8",children:[(0,r.jsx)("button",{onClick:()=>R(N-1),disabled:1===N,className:"px-3 py-1 rounded ".concat(1===N?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"),children:"前へ"}),Array.from({length:k},(e,s)=>s+1).map(e=>(0,r.jsx)("button",{onClick:()=>R(e),className:"px-3 py-1 rounded ".concat(N===e?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:e},e)),(0,r.jsx)("button",{onClick:()=>R(N+1),disabled:N===k,className:"px-3 py-1 rounded ".concat(N===k?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"),children:"次へ"})]})]})]})]})}):(0,r.jsx)(i.Z,{children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto py-12 text-center",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"ログインが必要です"}),(0,r.jsx)("p",{className:"text-gray-600 mb-8",children:"プロフィールを表示するにはログインしてください。"})]})})}},5753:function(e,s,t){"use strict";t.d(s,{V:function(){return r},n:function(){return a}});let r=e=>["タイムスタンプ,ステータス,場所",...e.map(e=>[e.timestamp,e.status,e.location]).map(e=>e.join(","))].join("\n"),a=(e,s)=>{let t=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),a=URL.createObjectURL(t);r.setAttribute("href",a),r.setAttribute("download",s),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}},function(e){e.O(0,[664,299,257,888,774,179],function(){return e(e.s=9813)}),_N_E=e.O()}]);